@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   DESIGN TOKENS - SINGLE SOURCE OF TRUTH

   Professional design system using CSS custom properties.
   All colors are defined once here and referenced via Tailwind.
   Theme switching happens automatically via the .dark class.
   ============================================ */

@layer base {
  :root {
    /* ========== BRAND ========== */
    --color-brand: 248 140 0;           /* #f88c00 - Primary orange */
    --color-brand-hover: 234 88 12;     /* #ea580c - Hover state */
    --color-brand-muted: 255 247 237;   /* #fff7ed - Light orange bg */

    /* ========== SURFACES ========== */
    --color-background: 250 250 250;    /* #fafafa - Page background */
    --color-surface: 255 255 255;       /* #ffffff - Cards, elevated */
    --color-surface-secondary: 244 244 245; /* #f4f4f5 - Subtle sections */
    --color-surface-tertiary: 228 228 231;  /* #e4e4e7 - Inputs, wells */

    /* ========== TEXT ========== */
    --color-text: 24 24 27;             /* #18181b - Primary text */
    --color-text-secondary: 82 82 91;   /* #52525b - Secondary text */
    --color-text-muted: 161 161 170;    /* #a1a1aa - Muted/placeholder */
    --color-text-inverted: 250 250 250; /* #fafafa - Text on dark bg */

    /* ========== BORDERS ========== */
    --color-border: 228 228 231;        /* #e4e4e7 - Default borders */
    --color-border-secondary: 212 212 216; /* #d4d4d8 - Subtle borders */

    /* ========== SEMANTIC ========== */
    --color-success: 34 197 94;         /* #22c55e */
    --color-warning: 234 179 8;         /* #eab308 */
    --color-error: 239 68 68;           /* #ef4444 */
    --color-info: 59 130 246;           /* #3b82f6 */

    /* ========== OVERLAYS ========== */
    --color-overlay: 0 0 0;             /* Black for overlays */
    --overlay-opacity: 0.5;
  }

  .dark {
    /* ========== SURFACES ========== */
    --color-background: 9 9 11;         /* #09090b - Page background */
    --color-surface: 24 24 27;          /* #18181b - Cards, elevated */
    --color-surface-secondary: 39 39 42;    /* #27272a - Subtle sections */
    --color-surface-tertiary: 63 63 70;     /* #3f3f46 - Inputs, wells */

    /* ========== TEXT ========== */
    --color-text: 250 250 250;          /* #fafafa - Primary text */
    --color-text-secondary: 161 161 170;    /* #a1a1aa - Secondary text */
    --color-text-muted: 113 113 122;    /* #71717a - Muted/placeholder */
    --color-text-inverted: 24 24 27;    /* #18181b - Text on light bg */

    /* ========== BORDERS ========== */
    --color-border: 39 39 42;           /* #27272a - Default borders */
    --color-border-secondary: 63 63 70; /* #3f3f46 - Subtle borders */

    /* ========== OVERLAYS ========== */
    --color-overlay: 0 0 0;
    --overlay-opacity: 0.7;
  }

  /* ========== BASE STYLES ========== */
  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-feature-settings: 'ss01' on, 'ss02' on, 'cv01' on;
  }

  /* Typography */
  h1, h2, h3, h4, h5, h6 {
    @apply font-display font-semibold tracking-tight;
  }

  /* Focus States */
  :focus-visible {
    @apply outline-none ring-2 ring-brand ring-offset-2 ring-offset-background;
  }

  :focus:not(:focus-visible) {
    @apply outline-none;
  }

  /* Selection */
  ::selection {
    background-color: rgb(var(--color-brand) / 0.2);
    color: rgb(var(--color-text));
  }
}

/* ============================================
   COMPONENT CLASSES
   Reusable patterns that use design tokens
   ============================================ */

@layer components {
  /* Container */
  .container {
    @apply mx-auto w-full max-w-7xl px-4 sm:px-6 lg:px-8;
  }

  .container-narrow {
    @apply mx-auto w-full max-w-3xl px-4 sm:px-6;
  }

  .container-wide {
    @apply mx-auto w-full max-w-[96rem] px-4 sm:px-6 lg:px-8;
  }

  /* ========== BUTTONS ========== */
  .btn {
    @apply inline-flex items-center justify-center gap-2;
    @apply px-6 py-3 font-semibold;
    @apply rounded-full;
    @apply transition-all duration-300;
    @apply focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-2;
  }

  .btn-primary {
    @apply btn bg-brand text-white;
    @apply hover:bg-brand-hover hover:scale-105 hover:shadow-lg;
  }

  .btn-secondary {
    @apply btn border-2 border-border text-foreground;
    @apply hover:bg-surface-secondary;
  }

  .btn-ghost {
    @apply btn text-muted;
    @apply hover:text-brand;
  }

  /* ========== CARDS ========== */
  .card {
    @apply bg-surface rounded-2xl border border-border;
    @apply transition-all duration-300;
  }

  .card-interactive {
    @apply card;
    @apply hover:shadow-xl hover:shadow-black/5 hover:-translate-y-1;
    @apply hover:border-brand/50;
  }

  .card-elevated {
    @apply card shadow-sm;
  }

  /* ========== SECTIONS ========== */
  .section {
    @apply py-24 lg:py-32;
  }

  .section-alt {
    @apply section bg-surface-secondary;
  }

  /* ========== INPUTS ========== */
  .input {
    @apply w-full px-4 py-3;
    @apply bg-surface-tertiary border border-border rounded-xl;
    @apply text-foreground placeholder:text-muted;
    @apply focus:outline-none focus:border-brand focus:ring-1 focus:ring-brand;
    @apply transition-colors;
  }

  /* ========== STAT CARDS ========== */
  .stat-card {
    @apply card border-2 border-brand/20 p-6 text-center;
    @apply hover:border-brand hover:shadow-lg;
  }

  .stat-number {
    @apply font-mono text-4xl md:text-5xl font-bold text-brand;
  }

  .stat-label {
    @apply text-xs uppercase tracking-wide text-muted mt-2;
  }

  /* ========== PROSE ========== */
  .prose p {
    @apply text-lg text-secondary mb-6 leading-relaxed;
  }

  .prose h2 {
    @apply text-2xl font-bold mt-12 mb-4;
  }

  .prose h3 {
    @apply text-xl font-bold mt-8 mb-3;
  }

  .prose a {
    @apply text-brand underline decoration-brand/30;
    @apply hover:decoration-brand transition-colors;
  }

  .prose ul, .prose ol {
    @apply my-6 ml-6;
  }

  .prose li {
    @apply text-lg text-secondary mb-2;
  }

  .prose blockquote {
    @apply border-l-4 border-brand pl-6 my-8;
    @apply text-xl italic text-muted;
    @apply max-w-full overflow-hidden;
  }
}

/* ============================================
   UTILITIES
   ============================================ */

@layer utilities {
  /* Text Gradient */
  .text-gradient {
    @apply bg-gradient-to-r from-brand to-orange-300;
    @apply bg-clip-text text-transparent;
  }

  /* Background Gradient */
  .bg-gradient-radial {
    background: radial-gradient(circle at center, var(--tw-gradient-stops));
  }

  /* Hide scrollbar */
  .hide-scrollbar,
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .hide-scrollbar::-webkit-scrollbar,
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Aspect ratios */
  .aspect-video-tall {
    aspect-ratio: 9/16;
  }
}

/* ============================================
   ANIMATIONS & REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* GSAP Animation Classes */
.gsap-reveal {
  visibility: hidden;
}

.gsap-reveal.is-revealed {
  visibility: visible;
}

/* ============================================
   ENHANCED BLOG POST STYLES
   ============================================ */

/* TL;DR Summary Box */
.tldr-box {
  @apply bg-gradient-to-br from-brand/10 to-orange-500/5;
  @apply border-l-4 border-brand;
  @apply p-6 rounded-r-2xl mb-12;
}

.tldr-box h4 {
  @apply font-display text-sm uppercase tracking-widest text-brand mb-3;
}

.tldr-box p {
  @apply text-lg text-foreground leading-relaxed mb-0;
}

/* Pull Quotes - needs high specificity to override prose styles */
.prose blockquote.pull-quote,
.prose .pull-quote,
blockquote.pull-quote,
.pull-quote {
  @apply my-12 py-6 px-4 text-center;
  @apply border-t border-b border-zinc-700;
  @apply max-w-full overflow-hidden box-border;
  /* Reset prose blockquote styles */
  border-left: none !important;
  border-left-width: 0 !important;
  background: transparent !important;
  background-color: transparent !important;
  border-radius: 0 !important;
  font-style: normal !important;
  padding-left: 1rem !important;
  padding-right: 1rem !important;
}

.prose blockquote.pull-quote,
.prose .pull-quote,
blockquote.pull-quote p,
.pull-quote p {
  @apply font-display text-xl md:text-2xl font-semibold;
  @apply text-zinc-200 leading-snug;
  margin: 0 !important;
  font-style: normal !important;
}

.pull-quote cite {
  @apply text-sm text-muted not-italic block mt-3;
}

/* Race Timeline */
.race-timeline {
  @apply my-12 p-6 bg-surface-secondary rounded-2xl;
}

.race-timeline h4 {
  @apply font-display text-lg font-semibold mb-4 text-foreground;
}

.timeline-item {
  @apply flex items-start gap-4 py-3 border-b border-border last:border-0;
}

.timeline-marker {
  @apply flex-shrink-0 w-12 h-12 rounded-full;
  @apply bg-brand/10 text-brand;
  @apply flex items-center justify-center;
  @apply font-mono text-sm font-bold;
}

.timeline-content {
  @apply flex-1;
}

.timeline-content h5 {
  @apply font-semibold text-foreground;
}

.timeline-content p {
  @apply text-sm text-muted mt-1 mb-0;
}

/* Stats Grid */
.stats-grid {
  @apply grid grid-cols-2 md:grid-cols-4 gap-4 my-12;
}

.stat-item {
  @apply bg-surface-secondary p-4 rounded-xl text-center;
}

.stat-item .value {
  @apply font-mono text-2xl md:text-3xl font-bold text-brand;
}

.stat-item .label {
  @apply text-xs uppercase tracking-wide text-muted mt-1;
}

/* Chapter Navigation */
.chapter-nav {
  @apply sticky top-24 hidden xl:block;
  @apply p-4 bg-surface rounded-xl border border-border;
}

.chapter-nav h4 {
  @apply text-xs uppercase tracking-widest text-muted mb-4;
}

.chapter-nav a {
  @apply block py-2 text-sm text-secondary;
  @apply hover:text-brand transition-colors;
  @apply border-l-2 border-transparent pl-3;
}

.chapter-nav a.active {
  @apply text-brand border-brand;
}

/* Image Gallery - Side by side */
.image-gallery {
  @apply grid grid-cols-1 sm:grid-cols-2 gap-4 my-10;
}

.image-gallery figure {
  @apply m-0 rounded-2xl overflow-hidden shadow-lg;
  @apply bg-zinc-900;
}

.image-gallery img {
  @apply w-full aspect-[4/3] object-cover;
  @apply transition-transform duration-500 hover:scale-105;
}

.image-gallery figcaption {
  @apply px-4 py-3 text-sm text-zinc-400 italic;
}

/* Race Photo - Single image with style */
.race-photo {
  @apply my-10 rounded-2xl overflow-hidden;
  @apply shadow-xl shadow-black/20;
  @apply border border-zinc-800;
}

.race-photo img {
  @apply w-full h-auto;
}

.race-photo figcaption {
  @apply px-5 py-4 bg-zinc-900/80 backdrop-blur-sm;
  @apply text-sm text-zinc-300 italic;
  @apply border-t border-zinc-800;
}

/* Photo Float - Image floated to side */
.photo-float-right {
  @apply float-right ml-6 mb-4 w-full sm:w-1/2 lg:w-2/5;
  @apply rounded-xl overflow-hidden shadow-lg;
  @apply border border-zinc-800;
}

.photo-float-left {
  @apply float-left mr-6 mb-4 w-full sm:w-1/2 lg:w-2/5;
  @apply rounded-xl overflow-hidden shadow-lg;
  @apply border border-zinc-800;
}

.photo-float-right img,
.photo-float-left img {
  @apply w-full h-auto;
}

.photo-float-right figcaption,
.photo-float-left figcaption {
  @apply px-4 py-2 bg-zinc-900 text-xs text-zinc-400 italic;
}

/* Legacy full-width - now contained */
.full-width-image {
  @apply my-10;
}

.full-width-image img {
  @apply w-full h-auto rounded-2xl;
}

/* Video Embeds - Responsive YouTube/Vimeo */
.video-embed {
  @apply my-10 rounded-2xl overflow-hidden shadow-xl;
  @apply border border-zinc-800;
  position: relative;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  height: 0;
}

.video-embed iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* Elevation Profile Placeholder */
.elevation-profile {
  @apply my-12 p-6 bg-surface-secondary rounded-2xl;
  @apply h-48 flex items-center justify-center;
}

.elevation-profile span {
  @apply text-muted text-sm;
}
